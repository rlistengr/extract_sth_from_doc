# extract_sth_from_doc

# 1. 安装python
# 2. 安装python-docx 使用命令pip3 install python-docx
# 运行该python程序，python 该程序名字 文档路径 正则表达式 是否去除重复（默认去除，false为不去重）
# 比如改成保存为extract.py 去重的方式抽取所有的书名，程序和文档在同一个路径下，且名字叫test.docx，
# 运行python extract.py test.docx ".*(《.*》).*"   
# 注意上面的破折号是中文输入法的，其他均是英文输入法的


from docx import Document

import sys
import os
import re

if len(sys.argv) < 3:
    print ("usage: extract.py file_path key_word remove_duplicates.\nthe remove_duplicates's default value is true.")
    sys.exit(1)

file_path = os.path.abspath(sys.argv[1])
key_word = sys.argv[2]
remove_duplicates = True
if len(sys.argv) > 3 and (sys.argv[3] == "False" or sys.argv[3] == "false"):
    remove_duplicates = False

print(file_path, key_word, remove_duplicates)

doc_handle = Document(file_path)
tables = doc_handle.tables;
records = []
for table in tables:
    n_rows = len(table.rows)
    n_columns = len(table.columns)
    for i in range(0, n_rows):
        for j in range(0, n_columns):
            text = table.cell(i, j).text
            linebits = re.match(key_word, text)
            if linebits:
                value = linebits.groups()[0]
                if value not in records:
                    records.append(value)

for record in records:
    print(record)
            
结果：
《水泥细度检验方法 筛析法》
《水泥胶砂强度检验方法（ISO 法）》
《水泥胶砂流动度测定方法》
《公路工程集料试验规程》
《用于水泥和混凝土中的粉煤灰》
《建筑施工扣件式钢管脚手架安全技术规范》
《金属管弯曲试验方法》
《钢筋机械连接技术规程》
《钢筋焊接接头试验方法标准》
《钢筋混凝土用钢 第 1 部分 热轧光圆钢筋》
《钢筋混凝土用钢 第1 部分热轧光圆钢筋》
《金属材料弯曲试验方法》
《金属材料 洛氏硬度试验 第 1 部分： 试验方法（A、B、C、D、E、F、G、H、K、 N、T 标尺）》
《预应力筋用锚具、夹具和连接器》
《普通混凝土配合比设计规程》
《普通混凝土力学性能试验方法标准》
《公路工程水泥及水泥混凝土试验规程》
《普通混凝土长期性能和耐久性能试验方法标准》
《水运工程混凝土试验规程》
《泡沫混凝土》
《水泥土配合比设计规程》
《砌筑砂浆配合比设计规程》
《建筑砂浆基本性能试验方法标准》
《绝热材料稳态热阻及有关持性的测定防护热板法》
《混凝土砌块和砖试验方法》
《蒸压加气混凝土性能试验方法》
《绝热材料稳态热阻及有关持性的测定 防护热板法》
《砌墙砖试验方法》
《天然饰面石材试验方法 第 2 部分：干燥水饱和弯曲强度试验方法》
《建筑防水卷材试验方法 第 8 部分：沥青防水卷材 拉伸性能》
《硫化橡胶或热塑性橡胶 拉伸应力应变性能的测定》
《硫化橡胶或热塑性橡胶撕裂强度的测定（裤形、直角形和新月形试样）》
《建筑防水卷材试验方法 第 11 部分：沥青防水卷材耐热性》
《建筑防水卷材试验方法 第 14 部分：沥青防水卷材 低温柔性》
《建筑防水卷材试验方法 第 15 部分：高分子防水卷材低温弯折性》
《建筑防水涂料试验方法》
《水泥基渗透结晶型防水材料》
《水性渗透型无机防水剂》
《合成树脂乳液外墙涂料》
《漆膜、腻子膜干燥时间测定法》
《漆膜耐水性测定法》
《建筑涂料涂层耐碱性的测定》
《建筑涂料涂层耐冻融循环性测定法》
《建筑涂料涂层耐洗刷性的测定》
《公路工程沥青及沥青混合料试验规程》
《沥青路面施工及验收规范》
《公路工程无机结合料稳定材料试验规程》
《公路路面基层施工技术细则》
《铸铁检查井盖》
《再生树脂复合材料水箅》
《城镇排水管道检测与评估技术规程》
《给水排水管道工程施工及验收规范》
《混凝土结构工程施工质量验收规范》
《回弹法检测混凝土抗压强度技术规程》
《钻芯法检测混凝土强度技术规程》
《超声回弹综合法检测混凝土强度技术规程》
《超声法检测混凝土缺陷技术规程》
《混凝土结构后锚固技术规程》
《建筑外门窗保温性能分级及检测方法》
《建筑桩基技术规范》
《建筑基桩检测技术规范》
《城市工程地球物理探测规范》
《基桩静载试验自平衡法》
《建筑地基处理技术规范》
《建筑地基基础设计规范》
《建筑基坑支护技术规程》
《民用建筑设计通则》
《建筑门窗工程检测技术规程》
《建筑玻璃应用技术规程》
《建筑给水排水及采暖工程施工质量验收规范》
《建筑给水排水设计规范》
《建筑给水排水及采暖工程施工质量验收规范 》
《住宅设计规范》
《建筑电气工程施工质量验收规范》
《通风与空调工程质量验收规范》
《民用建筑工程室内环境污染控制规范》
《胶粉聚苯颗粒外墙外保温系统材料》
《镀锌电焊网》
《膨胀聚苯板薄抹灰外墙保温系统》
《绝热用模塑聚苯乙烯泡沫塑料》
《膨胀聚苯板薄抹灰外墙外保温系统》
《绝热用模塑聚苯乙烯泡沫塑料（EPS）》
《无机轻集料砂浆保温系统应用技术规程》
《建筑保温砂浆》
《绝热材料稳态热阻及有关特性的测定防护热板法》
《绝热用岩棉、矿渣棉及其制品》
《绝热用硅酸铝棉及其制品》
《建筑用绝热制品 压缩性能的测定》
《无机硬质绝热制品试验方法》
《外墙保温工程技术规程》
《绝热 稳态热传递性质的测定 标定和防护热箱法》
《建筑节能工程施工质量验收规程》
《建筑节能工程施工质量验收规范》
《中空玻璃》
《建筑材料可燃性试验方法》
《额定电压 450/750V 及以下聚氯乙烯绝缘电缆 第 2 部分：试验方法》
《电线电缆电性能试验方法 第 4 部分：导体直流电阻试验》
《钢结构工程施工质量验收规范》
《金属材料 拉伸试验 第 1 部分：室温拉伸试验方法》
《金属材料 弯曲试验方法》
《金属材料 夏比摆锤冲击试验方法》
《焊缝无损检测  超声检测        技术、检测等级和评定》
《钢结构用高强度大六角头螺栓、大六角螺母、垫圈技术条件》
《钢结构用扭剪型高强度螺栓连接副》
《磁性基体上非磁性覆盖层厚度测量磁性法》
《建筑结构检测技术标》
《钢结构工程施工验收规范》
《普通混凝土用砂、石质量及检验方法标准》
《水泥胶砂强度检验方法》
《普通混凝土拌合物性能试验方法标准》
《金属材料 拉伸试验 第1部分：室温试验方法》
《户外广告设施技术规范》
《钢结构现场检测技术标准》
《移动通信工程钢塔桅结构验收规范》
《角钢类通信塔技术条件》
《建筑结构检测技术标准》
《色漆和清漆 漆膜的划格试验》
《塔桅钢结构工程施工质量验收规程》
《住宅厨房和卫生间排气道系统应用技术规程》

